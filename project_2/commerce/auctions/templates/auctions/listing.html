{% extends "auctions/layout.html" %}

{% block title %}
    {{ title }}
{% endblock %}

{% block body %}

<h2>Listing: {{ listing.title }}</h2>


<div class="listing">
    <div class="listing-top">
        {% if listing.imageURL %}
            <img src= "{{ listing.imageURL }}" alt="listingImage" height="400px" class="listing-image-single">
        {% else %}
            <div class="placeholder-rectangle-listing"></div>
        {% endif %}
        <div class = "bid">
            <h4 class="listing-bid">{{ listing.bid }}â‚¬</h4>
            {% if user.is_authenticated %}
                <form action="{% url 'listing' listing.title %}" method="post" class="bid-form">
                    <div class="mb-3">
                        {% csrf_token %}
                        {{ form.as_p }}
                        {% if messages %}
                            <div>
                                {% for message in messages %}
                                    <div class="alert custom-alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %}" role="alert">
                                        <div>{{ message | safe }}</div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% endif %}
                        <button type="submit" class="btn btn-primary btn-submit">Submit</button>
                    </div>
                </form>
                <form method="post">
                    {% csrf_token %}
                    {% if listing in user.watchlist.all %}
                        <button type="submit" name="remove_from_watchlist" class="btn btn-danger">Remove from Watchlist</button>
                    {% else %}
                        <button type="submit" name="add_to_watchlist" class="btn btn-primary">Add to Watchlist</button>
                    {% endif %}
                </form>
                
            {% endif %}
            
        </div>
        <div class = "listing-details">
            <div>Category: {{ listing.category }}</div>
            <div>Listed by {{ listing.created_by }}</div>
            <div>Last Bid by {{ listing.last_modifed_by }}</div>
            <div>Created time: {{ listing.created_at }}</div>
            <div>Updated time: {{ listing.updated_at }}</div>
        </div>
    </div>
    <div class="listing-bottom">
        <p class="listing-description-heading">Description</p>
        <p class="listing-description">{{ listing.description }}</p>
    </div>
    
</div>

{% endblock %}